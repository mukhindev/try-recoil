{"version":3,"sources":["state/atoms.ts","state/selectors.ts","components/Todo.tsx","components/Todos.tsx","components/App.tsx","hooks/useDebouncedEffect.ts","reportWebVitals.ts","index.tsx"],"names":["AtomKeys","SelectorKeys","todoState","atom","key","TodoState","default","id","title","completed","indexedTodoState","selector","IndexedTodoState","get","reduce","acc","todo","useStyles","makeStyles","theme","backgroundColor","palette","grey","Todo","onToggle","onDelete","classes","useRecoilValue","labelId","ListItem","className","role","undefined","dense","button","onClick","ListItemIcon","Checkbox","edge","color","checked","tabIndex","inputProps","disableRipple","ListItemText","primary","ListItemSecondaryAction","IconButton","size","Delete","fontSize","Todos","todos","List","map","defaultTheme","createTheme","light","main","dark","contrastText","secondary","app","background","height","display","alignItems","justifyContent","paper","width","maxWidth","breakpoints","values","sm","margin","spacing","flexDirection","completedButtons","alignSelf","addTodoField","completedLabel","paddingTop","paddingLeft","borderTop","divider","App","useRecoilState","setTodos","indexedTodos","useState","uncompletedTodos","setUncompletedTodos","completedTodos","setCompletedTodos","isShowCompleted","SetIsShowCompleted","delay","setDelay","newTodoTitle","setNewTodoTitle","effect","deps","useEffect","handler","setTimeout","clearTimeout","useDebouncedEffect","newUncompletedTodos","filter","newCompletedTodos","handleToggle","index","indexOf","newTodos","JSON","parse","stringify","find","handleDelete","splice","ThemeProvider","Paper","ButtonGroup","Button","variant","disabled","length","TextField","placeholder","onKeyDown","evt","newTodo","value","onInput","target","Collapse","in","timeout","unmountOnExit","Typography","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.b8db2bf4.chunk.js","sourcesContent":["import { atom } from 'recoil';\nimport { ITodoData } from '../types';\n\n/*\n  Атомы — источник истины приложения (главное состояние)\n*/\n\nenum AtomKeys {\n  TodoState = 'todoState',\n}\n\nexport const todoState = atom({\n  // Уникальный ключ атома\n  key: AtomKeys.TodoState,\n  // Состояние по-умолчанию\n  default: [\n    { id: 1, title: 'Купить молока', completed: false },\n    { id: 2, title: 'Починить кран', completed: false },\n    { id: 3, title: 'Построить дом', completed: false },\n    { id: 4, title: 'Посадить дерево', completed: false },\n    { id: 5, title: 'Выспаться', completed: false },\n  ] as ITodoData[],\n});\n","import { selector } from 'recoil';\nimport { todoState } from './atoms';\nimport { ITodoData } from '../types';\n\n/*\n  Селекторы — производное от атомов состояние\n*/\n\nenum SelectorKeys {\n  IndexedTodoState = 'indexedTodoState',\n}\n\n// Индексация массива todos в объект для удобного выбора по id\n// TODO: Попробовать мемоизировать индексированный объект\nexport const indexedTodoState = selector({\n  // Уникальный ключ селектора\n  key: SelectorKeys.IndexedTodoState,\n  get: ({ get }) => {\n    // Получаем текущее состояние из атома\n    const todos = get(todoState);\n    // Возвращаем производное\n    return todos.reduce((acc, todo) => {\n      acc[todo.id] = todo;\n      return acc;\n    }, {} as Record<string, ITodoData>);\n  },\n});\n","import React from 'react';\nimport {\n  Checkbox,\n  IconButton,\n  ListItem,\n  ListItemIcon,\n  ListItemSecondaryAction,\n  ListItemText,\n} from '@material-ui/core';\nimport { Delete as DeleteIcon } from '@material-ui/icons';\nimport { useRecoilValue } from 'recoil';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { ITodoData } from '../types';\nimport { indexedTodoState } from '../state';\n\nconst useStyles = makeStyles((theme) => {\n  return {\n    todo: {\n      '&:hover': {\n        backgroundColor: theme.palette.grey,\n      },\n    },\n  };\n});\n\ninterface ITodoProps {\n  todo: ITodoData,\n  onToggle: (id: number, completed: boolean) => void,\n  onDelete: (id: number) => void,\n}\n\nconst Todo: React.FC<ITodoProps> = ({ todo, onToggle, onDelete }) => {\n  const classes = useStyles();\n  const { id, title } = todo;\n  // Получаем селектором задачи в индексированном виде\n  const indexedTodos = useRecoilValue(indexedTodoState);\n  // Получаем свойство completed из соответствующей задачи\n  const completed = indexedTodos[id]?.completed || false;\n  const labelId = `checkbox-list-label-${id}`;\n\n  const handleToggle = () => {\n    onToggle(id, !completed);\n  };\n\n  const handleDelete = () => {\n    onDelete(id);\n  };\n\n  return (\n    <ListItem\n      className={classes.todo}\n      key={id}\n      role={undefined}\n      dense\n      button\n      onClick={handleToggle}\n    >\n      <ListItemIcon>\n        <Checkbox\n          edge=\"start\"\n          color=\"primary\"\n          checked={completed}\n          tabIndex={-1}\n          inputProps={{ 'aria-labelledby': labelId }}\n          disableRipple\n        />\n      </ListItemIcon>\n      <ListItemText id={labelId} primary={title} />\n      <ListItemSecondaryAction>\n        <IconButton\n          edge=\"end\"\n          aria-label=\"Удалить задачу\"\n          size=\"small\"\n          onClick={handleDelete}\n        >\n          <DeleteIcon fontSize=\"small\" color=\"error\" />\n        </IconButton>\n      </ListItemSecondaryAction>\n    </ListItem>\n  );\n};\n\nexport default Todo;\n","import React from 'react';\nimport { List } from '@material-ui/core';\nimport { ITodoData } from '../types';\nimport Todo from './Todo';\n\ninterface ITodoProps {\n  todos: ITodoData[],\n  onToggle: (id: number, completed: boolean) => void,\n  onDelete: (id: number) => void,\n}\n\nconst Todos: React.FC<ITodoProps> = ({ todos, onToggle, onDelete }) => {\n  return (\n    <List>\n      {todos.map((todo) => (\n        <Todo\n          key={todo.id}\n          todo={todo}\n          onToggle={onToggle}\n          onDelete={onDelete}\n        />\n      ))}\n    </List>\n  );\n};\n\nexport default Todos;\n","import React, { useState } from 'react';\nimport { createTheme, ThemeProvider, makeStyles } from '@material-ui/core/styles';\nimport {\n  Button,\n  ButtonGroup,\n  Collapse,\n  Paper,\n  TextField,\n  Typography,\n} from '@material-ui/core';\nimport {\n  CheckBoxOutlineBlank as UncheckIcon,\n  CheckBoxOutlined as CheckIcon,\n} from '@material-ui/icons';\nimport { useRecoilState, useRecoilValue } from 'recoil';\nimport { ITodoData } from '../types';\nimport { useDebouncedEffect } from '../hooks';\nimport Todos from './Todos';\nimport { indexedTodoState, todoState } from '../state';\n\nconst defaultTheme = createTheme({\n  palette: {\n    primary: {\n      light: '#63a4ff',\n      main: '#1976d2',\n      dark: '#004ba0',\n      contrastText: '#fff',\n    },\n    secondary: {\n      light: '#ff6659',\n      main: '#d32f2f',\n      dark: '#9a0007',\n      contrastText: '#fff',\n    },\n  },\n});\n\nconst useStyles = makeStyles((theme) => {\n  return {\n    app: {\n      background: theme.palette.background.default,\n      height: '100vh',\n      display: 'flex',\n      alignItems: 'flex-start',\n      justifyContent: 'center',\n    },\n    paper: {\n      width: '100%',\n      maxWidth: theme.breakpoints.values.sm,\n      margin: theme.spacing(4),\n      display: 'flex',\n      flexDirection: 'column',\n    },\n    completedButtons: {\n      alignSelf: 'center',\n      margin: theme.spacing(2),\n    },\n    addTodoField: {\n      margin: theme.spacing(2),\n    },\n    completedLabel: {\n      paddingTop: theme.spacing(2),\n      paddingLeft: theme.spacing(2),\n      borderTop: `1px solid ${theme.palette.divider}`,\n    },\n  };\n});\n\n// TODO: Выводить кол-во задач, завершенных и незавершенных\nconst App: React.FC = () => {\n  const classes = useStyles();\n  // Получаем состояние атома и его сеттер.\n  // useRecoilState аналогичен [useRecoilState, useSetRecoilState]\n  const [todos, setTodos] = useRecoilState(todoState);\n  // useRecoilValue, useRecoilState работают и с атомами и с селекторами\n  const indexedTodos = useRecoilValue(indexedTodoState);\n  const [uncompletedTodos, setUncompletedTodos] = useState<ITodoData[]>([]);\n  const [completedTodos, setCompletedTodos] = useState<ITodoData[]>([]);\n  const [isShowCompleted, SetIsShowCompleted] = useState(false);\n  const [delay, setDelay] = useState(0);\n  const [newTodoTitle, setNewTodoTitle] = useState('');\n\n  const distribute = () => {\n    const newUncompletedTodos = todos.filter((todo) => !todo.completed);\n    const newCompletedTodos = todos.filter((todo) => todo.completed);\n    setUncompletedTodos(newUncompletedTodos);\n    setCompletedTodos(newCompletedTodos);\n  };\n\n  // Перенос в список выполненных с задержкой\n  useDebouncedEffect(distribute, delay, [todos]);\n\n  const handleToggle = (id: number, completed: boolean) => {\n    const index = todos.indexOf(indexedTodos[id]);\n    const newTodos = JSON.parse(JSON.stringify(todos));\n    newTodos[index].completed = completed;\n    setTodos(newTodos);\n    // Если выполняемая задача в списке невыполненных, установить задержку\n    setDelay(uncompletedTodos.find((todo) => todo.id === newTodos[index].id) ? 2000 : 0);\n  };\n\n  const handleInputTodo = (evt: React.ChangeEvent<HTMLInputElement>) => {\n    setNewTodoTitle(evt.target.value);\n  };\n\n  const handleAddTodo = (evt: React.KeyboardEvent) => {\n    if (evt.key !== 'Enter') {\n      return;\n    }\n    if (!newTodoTitle) {\n      return;\n    }\n    const newTodo: ITodoData = {\n      id: todos[todos.length - 1]?.id + 1 || 1,\n      title: newTodoTitle,\n      completed: false,\n    };\n    setTodos([...todos, newTodo]);\n    setNewTodoTitle('');\n    setDelay(0);\n  };\n\n  const handleDelete = (id: number) => {\n    const index = todos.indexOf(indexedTodos[id]);\n    const newTodos = JSON.parse(JSON.stringify(todos));\n    newTodos.splice(index, 1);\n    setTodos(newTodos);\n    setDelay(0);\n  };\n\n  return (\n    <ThemeProvider theme={defaultTheme}>\n      <div className={classes.app}>\n        <Paper className={classes.paper}>\n          <ButtonGroup\n            className={classes.completedButtons}\n            color=\"primary\"\n            aria-label=\"Вид\"\n          >\n            <Button\n              variant=\"contained\"\n              color={isShowCompleted ? 'default' : 'primary'}\n              disabled={!completedTodos.length}\n              onClick={() => SetIsShowCompleted(false)}\n            >\n              <UncheckIcon />\n            </Button>\n            <Button\n              variant=\"contained\"\n              color={!isShowCompleted ? 'default' : 'primary'}\n              disabled={!completedTodos.length}\n              onClick={() => SetIsShowCompleted(true)}\n            >\n              <CheckIcon />\n            </Button>\n          </ButtonGroup>\n          {/* TODO: Выводить сообщение когда все задачи выполнены */}\n          <Todos\n            todos={uncompletedTodos}\n            onToggle={handleToggle}\n            onDelete={handleDelete}\n          />\n          <TextField\n            className={classes.addTodoField}\n            placeholder=\"Новая задача\"\n            onKeyDown={handleAddTodo}\n            value={newTodoTitle}\n            onInput={handleInputTodo}\n          />\n          <Collapse\n            in={isShowCompleted && !!completedTodos.length}\n            timeout=\"auto\"\n            unmountOnExit\n          >\n            <Typography className={classes.completedLabel}>Выполненные</Typography>\n            <Todos\n              todos={completedTodos}\n              onToggle={handleToggle}\n              onDelete={handleDelete}\n            />\n          </Collapse>\n        </Paper>\n      </div>\n    </ThemeProvider>\n  );\n};\n\nexport default App;\n","import { useEffect } from 'react';\n\nexport const useDebouncedEffect = (effect: () => void, delay: number, deps?: unknown[]): void => {\n  useEffect(() => {\n    const handler = setTimeout(effect, delay);\n\n    return () => clearTimeout(handler);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n};\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler): void => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({\n      getCLS, getFID, getFCP, getLCP, getTTFB,\n    }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { RecoilRoot } from 'recoil';\nimport './index.css';\nimport App from './components/App';\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <RecoilRoot>\n    <App />\n  </RecoilRoot>,\n  document.getElementById('root'),\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}